<!DOCTYPE html>
<meta charset="utf-8">
<style>
    body {
        font: 10px sans-serif;
    }
    
    svg text {
        fill: grey;
        font-size: 11px;
    }
    
    svg .values text {
        pointer-events: none;
        stroke-width: 0.5px;
    }
    
    .groups:hover {
        cursor: pointer;
        font-weight: bold;
    }
</style>

<body>
    <script src="./plugins/d3.v4.min.js"></script>
    <script src="./plugins/viz.v1.4.js"></script>
    <script>
        var data = [],
            arc = {};
        var colorArr = ["#da4480",
            "#5ab449",
            "#7f5acd",
            "#aab740",
            "#ce58c0",
            "#50a26e",
            "#d1434b",
            "#45c0bc",
            "#ce5929",
            "#4e7bda",
            "#d49d3c",
            "#6660a3",
            "#7b853c",
            "#b58dde",
            "#97622e",
            "#609dd6",
            "#e29074",
            "#9c4b88",
            "#ab505f",
            "#dc85b6"
        ];
        colorArr = colorArr.concat(d3.schemeCategory20c);
        d3.csv("./data/2019.csv", function(msg) {
            console.log(msg);
            msg.forEach(function(n) {
                arc[n.source] = arc[n.source] ? arc[n.source] + 1 : 1;
                arc[n.target] = arc[n.target] ? arc[n.target] + 1 : 1;
                var arr = [];
                arr[0] = n.source;
                arr[1] = n.target;
                arr[2] = n.weight;
                data.push(arr);
                var arr = [];
                arr[0] = n.target;
                arr[1] = n.source;
                arr[2] = n.weight;
                data.push(arr);
            })
            draw(data, arc);
        })

        function draw(data, arc) {
            console.log(data);
            console.log(arc);

            var colors = {
                "疾病": "#da4480",
                "症状": "#5ab449"
                    // ,"Bournemouth":    "#7f5acd"
                    // ,"Chelsea":        "#aab740"
                    // ,"Crystal Palace": "#ce58c0"
                    // ,"Everton":        "#50a26e"
                    // ,"Leicester City": "#d1434b"
                    // ,"Liverpool":      "#45c0bc"
                    // ,"Manchester City":"#ce5929"
                    // ,"Manchester Utd": "#4e7bda"
                    // ,"Newcastle Utd":  "#d49d3c"
                    // ,"Norwich City":   "#6660a3"
                    // ,"Southampton":    "#7b853c"
                    // ,"Stoke City":     "#b58dde"
                    // ,"Sunderland":     "#97622e"
                    // ,"Swansea City":   "#609dd6"
                    // ,"Tottenham":      "#e29074"
                    // ,"Watford":        "#9c4b88"
                    // ,"West Bromwich":  "#ab505f"
                    // ,"West Ham Utd":   "#dc85b6"
            };

            var sortOrder = [
                "疾病", "症状"
            ];
            for (var key in arc) {
                sortOrder.push(key);
                colors[key] = colorArr[arc[key] % colorArr.length];
            }
            colors["疾病"] = "#da4480";
            colors["症状"] = "#5ab449";
            console.log(colors);

            function sort(a, b) {
                return d3.ascending(sortOrder.indexOf(a), sortOrder.indexOf(b));
            }

            var ch = viz.chord().data(data)
                // .labelPadding(.01)
                .sort(sort)
                .label(function(d) {
                    return d.source;
                })
                .innerRadius(430)
                .outerRadius(450)
                .startAngle(0)
                // .duration(1000)
                .chordOpacity(0.3)
                // .fill(function(d) {
                //     return colors[d];
                // });
            ;

            var width = 1200,
                height = 1100;

            // var svg = d3.select("body").append("svg").attr("height", height).attr("width", width);

            // svg.append("g").attr("transform", "translate(600,550)").call(ch);

            // // adjust height of frame in bl.ocks.org
            // d3.select(self.frameElement).style("height", height + "px").style("width", width + "px");
        }
    </script>
<body>
    <div style="float:left;">
    <ul>
        <li><a href="2019-menzhen.html" target="myFrameName">2019门诊</a></li>
        <li><a href="2019-zhuyuan.html" target="myFrameName">2019住院</a></li>
        <li><a href="2018-menzhen.html" target="myFrameName">2018门诊</a></li>
        <li><a href="2018-zhuyuan.html" target="myFrameName">2018住院</a></li>
        <li><a href="2017-menzhen.html" target="myFrameName">2016门诊</a></li>
        <li><a href="2017-zhuyuan.html" target="myFrameName">2017住院</a></li>
        <li><a href="2016-menzhen.html" target="myFrameName">2016门诊</a></li>
        <li><a href="2016-zhuyuan.html" target="myFrameName">2016住院</a></li>
        <li><a href="2015-menzhen.html" target="myFrameName">2015门诊</a></li>
        <li><a href="2015-zhuyuan.html" target="myFrameName">2015住院</a></li>
        <li><a href="sample.html" target="myFrameName">sample</a></li>
    </ul>
</div>
<div style="float:right;">
    <iframe id="myFrameId" name="myFrameName" scrolling="no" frameborder="0" style="width:2000px; height:1500px; " src="2019-menzhen.html"></iframe>
</div>
</body>